<?php

class model_api
{
    private $user = 'root';
    private $pass = '';
    private $db = 'CTFara_nofrontend';
    private $conn;
    
    public function __construct()
    {
        $this->conn = new mysqli("localhost", $this->user, $this->pass, $this->db);
        if ($this->conn->connect_error) {
            die("Connection failed: " . $this->conn->connect_error);
        }    
        //return $conn;    
    }

    public function get_where($table, $column, $where)
    {
        $query = "SELECT * FROM `$table` WHERE `$column` = '$where'";
        $result = $this->conn->query($query); 
        $data = $result->fetch_all(MYSQLI_ASSOC); 
        if(!$data){
            return NULL;
        }else{
            return $data;
        }
    }

    public function get($table)
    {
        $query = "SELECT * FROM `$table`";
        $result = $this->conn->query($query); 
        $data = $result->fetch_all(MYSQLI_ASSOC); 
        if(!$data){
            return NULL;
        }else{
            return $data;
        }
    }

    public function insert($table, $column_value)
    {
        $query = "INSERT INTO $table (";
        foreach($column_value as $key => $value){
            $query = $query . $key . ",";
        }
        $query = substr($query, 0, strlen($query)-1). ") VALUES (";
        foreach($column_value as $key => $value){
            $query = $query . "'" .  $value . "' ,";
        }
        $query = substr($query, 0, strlen($query)-1) . ")";
        $result = $this->conn->query($query); 
        if(!$result){
            return 0;
        }else{
            return 1;
        }
    }

    public function verifyLogin($username, $password)
    {
        $query = "SELECT * FROM `account` WHERE `username` = '$username' AND `password` = '$password'";
        $result = $this->conn->query($query); 
        $data = $result->fetch_all(MYSQLI_ASSOC); 
        if(!$data){
            return 0;
        }else{
            return $data;
        }
    }
}






?>